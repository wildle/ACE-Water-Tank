\chapter{Theoretical Background}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.40\textwidth]{img/WaterTank_schematic.png}
    \caption{Schematic representation of the two-tank hydraulic system \cite{ACE_WT_Lab}}
    \label{fig:wt_physical}
\end{figure}

The water tank system consists of a basin, a pump, and two vertically arranged reservoirs.
Water is pumped from the basin into the upper reservoir and subsequently flows into the lower
reservoir through an outlet at the bottom of the upper tank. From the lower reservoir, the
water returns to the basin. Each reservoir is equipped with an emergency outlet that limits
the maximum admissible water height.

The system dynamics are governed by mass conservation and gravity-driven outflow. Assuming
incompressible fluid behaviour and constant density, the temporal change of the water level
in each reservoir can be described using the continuity equation. For a reservoir with
cross-sectional area $A_t$, the rate of change of the water level $h(t)$ is related to the
difference between inlet and outlet mass flows.

The outlet mass flow of each reservoir is determined by Torricelliâ€™s law, modified by a
pressure loss coefficient $\zeta$. This results in a nonlinear dependency between the water
level and the outflow velocity. Applying these relations to the upper reservoir yields
\[
    \dot{h}_1(t) = \frac{\dot{m}_{\mathrm{in}}(t)}{\rho A_t}
    - \frac{A_{\mathrm{out}}}{A_t}
    \sqrt{\frac{2 g h_1(t)}{1 + \zeta}},
\]
where $\dot{m}_{\mathrm{in}}(t)$ denotes the mass flow generated by the pump. Since the outlet
of the upper reservoir directly feeds the lower reservoir, the dynamics of the second tank
are given by
\[
    \dot{h}_2(t) =
    \frac{A_{\mathrm{out}}}{A_t}
    \sqrt{\frac{2 g h_1(t)}{1 + \zeta}}
    - \frac{A_{\mathrm{out}}}{A_t}
    \sqrt{\frac{2 g h_2(t)}{1 + \zeta}}.
\]

Defining the state vector as
\[
    x = \begin{bmatrix}
        h_1 \\ h_2
    \end{bmatrix},
\]
and selecting the pump mass flow as control input, the nonlinear system can be written in
state-space form as
\[
    \dot{x}(t) = f(x(t),u(t)),
\]
with the system output chosen as the water level of the lower reservoir,
\[
    y(t) = h_2(t).
\]

The nonlinear square-root terms complicate direct controller design. Therefore, the model is
linearized around a steady-state operating point corresponding to a constant water level in
the lower reservoir. Linearization yields a local linear time-invariant approximation that is
suitable for classical control design methods. From this linearized model, a transfer function
between pump input and water level can be derived.

PID control is employed as the primary regulation strategy in this laboratory. The controller
parameters are designed based on the linearized model and subsequently validated using the
nonlinear plant. Practical constraints such as actuator saturation, sensor noise, and physical
limits of the water levels influence the achievable control performance and must be taken into
account during tuning.

In addition to feedback control, a flatness-based feed-forward approach is considered. The
water level of the lower reservoir acts as a flat output of the nonlinear system, allowing all
states and inputs to be expressed in terms of this output and its derivatives. This property
enables the generation of smooth reference trajectories and corresponding feed-forward inputs,
which improve tracking performance during transient operating phases.
